angular.module("API",[]).factory("API",["$rootScope","$location","$route","$routeParams",function(e,t,n,r){var i={};i.Helpers={path:undefined,popup:undefined};i.Resources={Session:undefined};i.Scope=e;i.REST={query:function(e,t,n,s){i.Scope.loader=true;i.Scope[t]=false;var n=n||{id:r.id};i.Resources[e].query(n).$promise.then(function(e){console.log("API Query: "+JSON.stringify(e.objects||e));i.Scope.loader=false;i.Scope[t]=e.objects||e;if(s)s()},function(e){i.Scope.loader=false})},select:function(e,t){i.Scope[e]=t;return true},create:function(e,t,r,s){console.log(t);i.Scope.loader=true;i.Resources[e].create(t).$promise.then(function(e){console.log("API Create: "+JSON.stringify(e));i.Scope.loader=false;i.Helpers.popup(r,true);n.reload();if(s)s()},function(e){i.Scope.loader=false})},update:function(e,t,n,r){console.log(t);i.Scope.loader=true;i.Resources[e].update(t).$promise.then(function(e){console.log("API Update: "+JSON.stringify(e));i.Scope.loader=false;i.Helpers.popup(n,true);if(r)r()},function(e){i.Scope.loader=false})},remove:function(e,t,n,r,s){object=i.Scope[t];console.log(object);i.Scope.loader=true;i.Resources[e].remove({id:object.id}).$promise.then(function(e){console.log("API Remove: "+JSON.stringify(e));i.Scope.loader=false;i.Helpers.popup(n,true);$(r+object.id).remove();if(s)s()},function(e){i.Scope.loader=false})}};i.Session={check:function(){user=window.SessionUser||false;console.log("check session: "+user);if(user){i.Scope.user=user;console.log("Logged In "+user.first_name);if(t.path()=="/"){t.path(i.Helpers.path())}}else{console.log("Not Logged In");t.path("/");return false}},login:function(e,n){console.log(e);i.Scope.loader=true;i.Resources.Session.create(e).$promise.then(function(e){console.log(e);i.Scope.loader=false;window.SessionUser=e;i.Scope.user=e;if(n)n();t.path(i.Helpers.path())},function(){i.Scope.loader=false})},logout:function(e){console.log(i.Scope.user.type);i.Scope.loader=true;i.Resources.Session.remove({id:i.Scope.user.type}).$promise.then(function(n){i.Scope.loader=false;i.Scope.user=undefined;if(window.SessionUser||false){window.SessionUser=undefined}if(e)e();t.path("/")},function(){i.Scope.loader=false})}};return i}])